<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>LCOV - .coverage.total - /home/schneg/Projects/openFrameworks/libs/openFrameworks/utils/ofNoise.h</title>
  <link rel="stylesheet" type="text/css" href="../../../../../../../gcov.css">
</head>

<body>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="title">LCOV - code coverage report</td></tr>
    <tr><td class="ruler"><img src="../../../../../../../glass.png" width=3 height=3 alt=""></td></tr>

    <tr>
      <td width="100%">
        <table cellpadding=1 border=0 width="100%">
          <tr>
            <td width="10%" class="headerItem">Current view:</td>
            <td width="35%" class="headerValue"><a href="../../../../../../../index.html">top level</a> - <a href="index.html">home/schneg/Projects/openFrameworks/libs/openFrameworks/utils</a> - ofNoise.h<span style="font-size: 80%;"> (source / <a href="ofNoise.h.func.html">functions</a>)</span></td>
            <td width="5%"></td>
            <td width="15%"></td>
            <td width="10%" class="headerCovTableHead">Hit</td>
            <td width="10%" class="headerCovTableHead">Total</td>
            <td width="15%" class="headerCovTableHead">Coverage</td>
          </tr>
          <tr>
            <td class="headerItem">Test:</td>
            <td class="headerValue">.coverage.total</td>
            <td></td>
            <td class="headerItem">Lines:</td>
            <td class="headerCovTableEntry">196</td>
            <td class="headerCovTableEntry">196</td>
            <td class="headerCovTableEntryHi">100.0 %</td>
          </tr>
          <tr>
            <td class="headerItem">Date:</td>
            <td class="headerValue">2012-08-09</td>
            <td></td>
            <td class="headerItem">Functions:</td>
            <td class="headerCovTableEntry">8</td>
            <td class="headerCovTableEntry">8</td>
            <td class="headerCovTableEntryHi">100.0 %</td>
          </tr>
          <tr><td><img src="../../../../../../../glass.png" width=3 height=3 alt=""></td></tr>
        </table>
      </td>
    </tr>

    <tr><td class="ruler"><img src="../../../../../../../glass.png" width=3 height=3 alt=""></td></tr>
  </table>

  <table cellpadding=0 cellspacing=0 border=0>
    <tr>
      <td><br></td>
    </tr>
    <tr>
      <td>
<pre class="sourceHeading">          Line data    Source code</pre>
<pre class="source">
<a name="1"><span class="lineNum">       1 </span>            : #pragma once</a>
<span class="lineNum">       2 </span>            : 
<span class="lineNum">       3 </span>            : 
<span class="lineNum">       4 </span>            : /*
<span class="lineNum">       5 </span>            :  * Mesa 3-D graphics library
<span class="lineNum">       6 </span>            :  * Version:  6.5
<span class="lineNum">       7 </span>            :  *
<span class="lineNum">       8 </span>            :  * Copyright (C) 2006  Brian Paul   All Rights Reserved.
<span class="lineNum">       9 </span>            :  *
<span class="lineNum">      10 </span>            :  * Permission is hereby granted, free of charge, to any person obtaining a
<span class="lineNum">      11 </span>            :  * copy of this software and associated documentation files (the &quot;Software&quot;),
<span class="lineNum">      12 </span>            :  * to deal in the Software without restriction, including without limitation
<span class="lineNum">      13 </span>            :  * the rights to use, copy, modify, merge, publish, distribute, sublicense,
<span class="lineNum">      14 </span>            :  * and/or sell copies of the Software, and to permit persons to whom the
<span class="lineNum">      15 </span>            :  * Software is furnished to do so, subject to the following conditions:
<span class="lineNum">      16 </span>            :  *
<span class="lineNum">      17 </span>            :  * The above copyright notice and this permission notice shall be included
<span class="lineNum">      18 </span>            :  * in all copies or substantial portions of the Software.
<span class="lineNum">      19 </span>            :  *
<span class="lineNum">      20 </span>            :  * THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS
<span class="lineNum">      21 </span>            :  * OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
<span class="lineNum">      22 </span>            :  * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL
<span class="lineNum">      23 </span>            :  * BRIAN PAUL BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN
<span class="lineNum">      24 </span>            :  * AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
<span class="lineNum">      25 </span>            :  * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
<span class="lineNum">      26 </span>            :  */
<span class="lineNum">      27 </span>            : 
<span class="lineNum">      28 </span>            : /*
<span class="lineNum">      29 </span>            :  * SimplexNoise1234
<span class="lineNum">      30 </span>            :  * Copyright (c) 2003-2005, Stefan Gustavson
<span class="lineNum">      31 </span>            :  *
<span class="lineNum">      32 </span>            :  * Contact: stegu@itn.liu.se
<span class="lineNum">      33 </span>            :  */
<span class="lineNum">      34 </span>            : 
<span class="lineNum">      35 </span>            : /** \file
<span class="lineNum">      36 </span>            :     \brief C implementation of Perlin Simplex Noise over 1,2,3, and 4 dimensions.
<span class="lineNum">      37 </span>            :     \author Stefan Gustavson (stegu@itn.liu.se)
<span class="lineNum">      38 </span>            : */
<span class="lineNum">      39 </span>            : 
<span class="lineNum">      40 </span>            : /*
<span class="lineNum">      41 </span>            :  * This implementation is &quot;Simplex Noise&quot; as presented by
<span class="lineNum">      42 </span>            :  * Ken Perlin at a relatively obscure and not often cited course
<span class="lineNum">      43 </span>            :  * session &quot;Real-Time Shading&quot; at Siggraph 2001 (before real
<span class="lineNum">      44 </span>            :  * time shading actually took on), under the title &quot;hardware noise&quot;.
<span class="lineNum">      45 </span>            :  * The 3D function is numerically equivalent to his Java reference
<span class="lineNum">      46 </span>            :  * code available in the PDF course notes, although I re-implemented
<span class="lineNum">      47 </span>            :  * it from scratch to get more readable code. The 1D, 2D and 4D cases
<span class="lineNum">      48 </span>            :  * were implemented from scratch by me from Ken Perlin's text.
<span class="lineNum">      49 </span>            :  *
<span class="lineNum">      50 </span>            :  * This file has no dependencies on any other file, not even its own
<span class="lineNum">      51 </span>            :  * header file. The header file is made for use by external code only.
<span class="lineNum">      52 </span>            :  */
<span class="lineNum">      53 </span>            : 
<span class="lineNum">      54 </span>            : #define FASTFLOOR(x) ( ((x)&gt;0) ? ((int)x) : (((int)x)-1) )
<span class="lineNum">      55 </span>            : 
<span class="lineNum">      56 </span>            : /*
<span class="lineNum">      57 </span>            :  * ---------------------------------------------------------------------
<span class="lineNum">      58 </span>            :  * Static data
<span class="lineNum">      59 </span>            :  */
<span class="lineNum">      60 </span>            : 
<span class="lineNum">      61 </span>            : /*
<span class="lineNum">      62 </span>            :  * Permutation table. This is just a random jumble of all numbers 0-255,
<span class="lineNum">      63 </span>            :  * repeated twice to avoid wrapping the index at 255 for each lookup.
<span class="lineNum">      64 </span>            :  * This needs to be exactly the same for all instances on all platforms,
<span class="lineNum">      65 </span>            :  * so it's easiest to just keep it as static explicit data.
<span class="lineNum">      66 </span>            :  * This also removes the need for any initialisation of this class.
<span class="lineNum">      67 </span>            :  *
<span class="lineNum">      68 </span>            :  * Note that making this an int[] instead of a char[] might make the
<span class="lineNum">      69 </span>            :  * code run faster on platforms with a high penalty for unaligned single
<span class="lineNum">      70 </span>            :  * byte addressing. Intel x86 is generally single-byte-friendly, but
<span class="lineNum">      71 </span>            :  * some other CPUs are faster with 4-aligned reads.
<span class="lineNum">      72 </span>            :  * However, a char[] is smaller, which avoids cache trashing, and that
<span class="lineNum">      73 </span>            :  * is probably the most important aspect on most architectures.
<span class="lineNum">      74 </span>            :  * This array is accessed a *lot* by the noise functions.
<span class="lineNum">      75 </span>            :  * A vector-valued noise over 3D accesses it 96 times, and a
<span class="lineNum">      76 </span>            :  * float-valued 4D noise 64 times. We want this to fit in the cache!
<span class="lineNum">      77 </span>            :  */
<span class="lineNum">      78 </span>            : static unsigned char perm[512] = {151,160,137,91,90,15,
<span class="lineNum">      79 </span>            :   131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,
<span class="lineNum">      80 </span>            :   190, 6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,
<span class="lineNum">      81 </span>            :   88,237,149,56,87,174,20,125,136,171,168, 68,175,74,165,71,134,139,48,27,166,
<span class="lineNum">      82 </span>            :   77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,
<span class="lineNum">      83 </span>            :   102,143,54, 65,25,63,161, 1,216,80,73,209,76,132,187,208, 89,18,169,200,196,
<span class="lineNum">      84 </span>            :   135,130,116,188,159,86,164,100,109,198,173,186, 3,64,52,217,226,250,124,123,
<span class="lineNum">      85 </span>            :   5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,
<span class="lineNum">      86 </span>            :   223,183,170,213,119,248,152, 2,44,154,163, 70,221,153,101,155,167, 43,172,9,
<span class="lineNum">      87 </span>            :   129,22,39,253, 19,98,108,110,79,113,224,232,178,185, 112,104,218,246,97,228,
<span class="lineNum">      88 </span>            :   251,34,242,193,238,210,144,12,191,179,162,241, 81,51,145,235,249,14,239,107,
<span class="lineNum">      89 </span>            :   49,192,214, 31,181,199,106,157,184, 84,204,176,115,121,50,45,127, 4,150,254,
<span class="lineNum">      90 </span>            :   138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180,
<span class="lineNum">      91 </span>            :   151,160,137,91,90,15,
<span class="lineNum">      92 </span>            :   131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,
<span class="lineNum">      93 </span>            :   190, 6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,
<span class="lineNum">      94 </span>            :   88,237,149,56,87,174,20,125,136,171,168, 68,175,74,165,71,134,139,48,27,166,
<span class="lineNum">      95 </span>            :   77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,
<span class="lineNum">      96 </span>            :   102,143,54, 65,25,63,161, 1,216,80,73,209,76,132,187,208, 89,18,169,200,196,
<span class="lineNum">      97 </span>            :   135,130,116,188,159,86,164,100,109,198,173,186, 3,64,52,217,226,250,124,123,
<span class="lineNum">      98 </span>            :   5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,
<span class="lineNum">      99 </span>            :   223,183,170,213,119,248,152, 2,44,154,163, 70,221,153,101,155,167, 43,172,9,
<span class="lineNum">     100 </span>            :   129,22,39,253, 19,98,108,110,79,113,224,232,178,185, 112,104,218,246,97,228,
<span class="lineNum">     101 </span>            :   251,34,242,193,238,210,144,12,191,179,162,241, 81,51,145,235,249,14,239,107,
<span class="lineNum">     102 </span>            :   49,192,214, 31,181,199,106,157,184, 84,204,176,115,121,50,45,127, 4,150,254,
<span class="lineNum">     103 </span>            :   138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180 
<span class="lineNum">     104 </span>            : };
<span class="lineNum">     105 </span>            : 
<span class="lineNum">     106 </span>            : /*
<span class="lineNum">     107 </span>            :  * ---------------------------------------------------------------------
<span class="lineNum">     108 </span>            :  */
<span class="lineNum">     109 </span>            : 
<span class="lineNum">     110 </span>            : /*
<span class="lineNum">     111 </span>            :  * Helper functions to compute gradients-dot-residualvectors (1D to 4D)
<span class="lineNum">     112 </span>            :  * Note that these generate gradients of more than unit length. To make
<span class="lineNum">     113 </span>            :  * a close match with the value range of classic Perlin noise, the final
<span class="lineNum">     114 </span>            :  * noise values need to be rescaled to fit nicely within [-1,1].
<span class="lineNum">     115 </span>            :  * (The simplex noise functions as such also have different scaling.)
<span class="lineNum">     116 </span>            :  * Note also that these noise functions are the most practical and useful
<span class="lineNum">     117 </span>            :  * signed version of Perlin noise. To return values according to the
<span class="lineNum">     118 </span>            :  * RenderMan specification from the SL noise() and pnoise() functions,
<span class="lineNum">     119 </span>            :  * the noise values need to be scaled and offset to [0,1], like this:
<span class="lineNum">     120 </span>            :  * float SLnoise = (SimplexNoise1234::noise(x,y,z) + 1.0) * 0.5;
<a name="121"><span class="lineNum">     121 </span>            :  */</a>
<a name="122"><span class="lineNum">     122 </span>            : </a>
<span class="lineNum">     123 </span><span class="lineCov">    9004070 : static float  grad1( int hash, float x ) {</span>
<span class="lineNum">     124 </span><span class="lineCov">    9004070 :     int h = hash &amp; 15;</span>
<span class="lineNum">     125 </span><span class="lineCov">    9004070 :     float grad = 1.0f + (h &amp; 7);   /* Gradient value 1.0, 2.0, ..., 8.0 */</span>
<span class="lineNum">     126 </span><span class="lineCov">    9004070 :     if (h&amp;8) grad = -grad;         /* Set a random sign for the gradient */</span>
<span class="lineNum">     127 </span><span class="lineCov">    9004070 :     return ( grad * x );           /* Multiply the gradient with the distance */</span>
<a name="128"><span class="lineNum">     128 </span>            : }</a>
<span class="lineNum">     129 </span>            : 
<span class="lineNum">     130 </span><span class="lineCov">    1553497 : static float  grad2( int hash, float x, float y ) {</span>
<span class="lineNum">     131 </span><span class="lineCov">    1553497 :     int h = hash &amp; 7;      /* Convert low 3 bits of hash code */</span>
<span class="lineNum">     132 </span><span class="lineCov">    1553497 :     float u = h&lt;4 ? x : y;  /* into 8 simple gradient directions, */</span>
<span class="lineNum">     133 </span><span class="lineCov">    1553497 :     float v = h&lt;4 ? y : x;  /* and compute the dot product with (x,y). */</span>
<span class="lineNum">     134 </span><span class="lineCov">    1553497 :     return ((h&amp;1)? -u : u) + ((h&amp;2)? -2.0f*v : 2.0f*v);</span>
<a name="135"><span class="lineNum">     135 </span>            : }</a>
<span class="lineNum">     136 </span>            : 
<span class="lineNum">     137 </span><span class="lineCov">   92471644 : static float  grad3( int hash, float x, float y , float z ) {</span>
<span class="lineNum">     138 </span><span class="lineCov">   92471644 :     int h = hash &amp; 15;     /* Convert low 4 bits of hash code into 12 simple */</span>
<span class="lineNum">     139 </span><span class="lineCov">   92471644 :     float u = h&lt;8 ? x : y; /* gradient directions, and compute dot product. */</span>
<span class="lineNum">     140 </span><span class="lineCov">   92471644 :     float v = h&lt;4 ? y : h==12||h==14 ? x : z; /* Fix repeats at h = 12 to 15 */</span>
<span class="lineNum">     141 </span><span class="lineCov">   92471644 :     return ((h&amp;1)? -u : u) + ((h&amp;2)? -v : v);</span>
<a name="142"><span class="lineNum">     142 </span>            : }</a>
<span class="lineNum">     143 </span>            : 
<span class="lineNum">     144 </span><span class="lineCov">  177509416 : static float  grad4( int hash, float x, float y, float z, float t ) {</span>
<span class="lineNum">     145 </span><span class="lineCov">  177509416 :     int h = hash &amp; 31;      /* Convert low 5 bits of hash code into 32 simple */</span>
<span class="lineNum">     146 </span><span class="lineCov">  177509416 :     float u = h&lt;24 ? x : y; /* gradient directions, and compute dot product. */</span>
<span class="lineNum">     147 </span><span class="lineCov">  177509416 :     float v = h&lt;16 ? y : z;</span>
<span class="lineNum">     148 </span><span class="lineCov">  177509416 :     float w = h&lt;8 ? z : t;</span>
<span class="lineNum">     149 </span><span class="lineCov">  177509416 :     return ((h&amp;1)? -u : u) + ((h&amp;2)? -v : v) + ((h&amp;4)? -w : w);</span>
<span class="lineNum">     150 </span>            : }
<span class="lineNum">     151 </span>            : 
<span class="lineNum">     152 </span>            :   /* A lookup table to traverse the simplex around a given point in 4D. */
<span class="lineNum">     153 </span>            :   /* Details can be found where this table is used, in the 4D noise method. */
<span class="lineNum">     154 </span>            :   /* TODO: This should not be required, backport it from Bill's GLSL code! */
<span class="lineNum">     155 </span>            :   static unsigned char simplex[64][4] = {
<span class="lineNum">     156 </span>            :     {0,1,2,3},{0,1,3,2},{0,0,0,0},{0,2,3,1},{0,0,0,0},{0,0,0,0},{0,0,0,0},{1,2,3,0},
<span class="lineNum">     157 </span>            :     {0,2,1,3},{0,0,0,0},{0,3,1,2},{0,3,2,1},{0,0,0,0},{0,0,0,0},{0,0,0,0},{1,3,2,0},
<span class="lineNum">     158 </span>            :     {0,0,0,0},{0,0,0,0},{0,0,0,0},{0,0,0,0},{0,0,0,0},{0,0,0,0},{0,0,0,0},{0,0,0,0},
<span class="lineNum">     159 </span>            :     {1,2,0,3},{0,0,0,0},{1,3,0,2},{0,0,0,0},{0,0,0,0},{0,0,0,0},{2,3,0,1},{2,3,1,0},
<span class="lineNum">     160 </span>            :     {1,0,2,3},{1,0,3,2},{0,0,0,0},{0,0,0,0},{0,0,0,0},{2,0,3,1},{0,0,0,0},{2,1,3,0},
<span class="lineNum">     161 </span>            :     {0,0,0,0},{0,0,0,0},{0,0,0,0},{0,0,0,0},{0,0,0,0},{0,0,0,0},{0,0,0,0},{0,0,0,0},
<span class="lineNum">     162 </span>            :     {2,0,1,3},{0,0,0,0},{0,0,0,0},{0,0,0,0},{3,0,1,2},{3,0,2,1},{0,0,0,0},{3,1,2,0},
<span class="lineNum">     163 </span>            :     {2,1,0,3},{0,0,0,0},{0,0,0,0},{0,0,0,0},{3,1,0,2},{0,0,0,0},{3,2,0,1},{3,2,1,0}};
<span class="lineNum">     164 </span>            : 
<span class="lineNum">     165 </span>            : /* 1D simplex noise */
<span class="lineNum">     166 </span><span class="lineCov">    4502035 : static float _slang_library_noise1 (float x)</span>
<span class="lineNum">     167 </span>            : {
<span class="lineNum">     168 </span><span class="lineCov">    4502035 :   int i0 = FASTFLOOR(x);</span>
<span class="lineNum">     169 </span><span class="lineCov">    4502035 :   int i1 = i0 + 1;</span>
<span class="lineNum">     170 </span><span class="lineCov">    4502035 :   float x0 = x - i0;</span>
<span class="lineNum">     171 </span><span class="lineCov">    4502035 :   float x1 = x0 - 1.0f;</span>
<span class="lineNum">     172 </span><span class="lineCov">    4502035 :   float t1 = 1.0f - x1*x1;</span>
<span class="lineNum">     173 </span>            :   float n0, n1;
<span class="lineNum">     174 </span>            : 
<span class="lineNum">     175 </span><span class="lineCov">    4502035 :   float t0 = 1.0f - x0*x0;</span>
<span class="lineNum">     176 </span>            : /*  if(t0 &lt; 0.0f) t0 = 0.0f; // this never happens for the 1D case */
<span class="lineNum">     177 </span><span class="lineCov">    4502035 :   t0 *= t0;</span>
<span class="lineNum">     178 </span><span class="lineCov">    4502035 :   n0 = t0 * t0 * grad1(perm[i0 &amp; 0xff], x0);</span>
<span class="lineNum">     179 </span>            : 
<span class="lineNum">     180 </span>            : /*  if(t1 &lt; 0.0f) t1 = 0.0f; // this never happens for the 1D case */
<span class="lineNum">     181 </span><span class="lineCov">    4502035 :   t1 *= t1;</span>
<span class="lineNum">     182 </span><span class="lineCov">    4502035 :   n1 = t1 * t1 * grad1(perm[i1 &amp; 0xff], x1);</span>
<span class="lineNum">     183 </span>            :   /* The maximum value of this noise is 8*(3/4)^4 = 2.53125 */
<span class="lineNum">     184 </span>            :   /* A factor of 0.395 would scale to fit exactly within [-1,1], but */
<span class="lineNum">     185 </span>            :   /* we want to match PRMan's 1D noise, so we scale it down some more. */
<span class="lineNum">     186 </span><span class="lineCov">    4502035 :   return 0.25f * (n0 + n1);</span>
<span class="lineNum">     187 </span>            : }
<a name="188"><span class="lineNum">     188 </span>            : </a>
<span class="lineNum">     189 </span>            : /* 2D simplex noise */
<span class="lineNum">     190 </span><span class="lineCov">     570912 : static float _slang_library_noise2 (float x, float y)</span>
<span class="lineNum">     191 </span>            : {
<span class="lineNum">     192 </span>            : #define F2 0.366025403f /* F2 = 0.5*(sqrt(3.0)-1.0) */
<span class="lineNum">     193 </span>            : #define G2 0.211324865f /* G2 = (3.0-Math.sqrt(3.0))/6.0 */
<span class="lineNum">     194 </span>            : 
<span class="lineNum">     195 </span>            :     float n0, n1, n2; /* Noise contributions from the three corners */
<span class="lineNum">     196 </span>            : 
<span class="lineNum">     197 </span>            :     /* Skew the input space to determine which simplex cell we're in */
<span class="lineNum">     198 </span><span class="lineCov">     570912 :     float s = (x+y)*F2; /* Hairy factor for 2D */</span>
<span class="lineNum">     199 </span><span class="lineCov">     570912 :     float xs = x + s;</span>
<span class="lineNum">     200 </span><span class="lineCov">     570912 :     float ys = y + s;</span>
<span class="lineNum">     201 </span><span class="lineCov">     570912 :     int i = FASTFLOOR(xs);</span>
<span class="lineNum">     202 </span><span class="lineCov">     570912 :     int j = FASTFLOOR(ys);</span>
<span class="lineNum">     203 </span>            : 
<span class="lineNum">     204 </span><span class="lineCov">     570912 :     float t = (float)(i+j)*G2;</span>
<span class="lineNum">     205 </span><span class="lineCov">     570912 :     float X0 = i-t; /* Unskew the cell origin back to (x,y) space */</span>
<span class="lineNum">     206 </span><span class="lineCov">     570912 :     float Y0 = j-t;</span>
<span class="lineNum">     207 </span><span class="lineCov">     570912 :     float x0 = x-X0; /* The x,y distances from the cell origin */</span>
<span class="lineNum">     208 </span><span class="lineCov">     570912 :     float y0 = y-Y0;</span>
<span class="lineNum">     209 </span>            : 
<span class="lineNum">     210 </span>            :     float x1, y1, x2, y2;
<span class="lineNum">     211 </span>            :     int ii, jj;
<span class="lineNum">     212 </span>            :     float t0, t1, t2;
<span class="lineNum">     213 </span>            : 
<span class="lineNum">     214 </span>            :     /* For the 2D case, the simplex shape is an equilateral triangle. */
<span class="lineNum">     215 </span>            :     /* Determine which simplex we are in. */
<span class="lineNum">     216 </span>            :     int i1, j1; /* Offsets for second (middle) corner of simplex in (i,j) coords */
<span class="lineNum">     217 </span><span class="lineCov">     570912 :     if(x0&gt;y0) {i1=1; j1=0;} /* lower triangle, XY order: (0,0)-&gt;(1,0)-&gt;(1,1) */</span>
<span class="lineNum">     218 </span><span class="lineCov">     285662 :     else {i1=0; j1=1;}      /* upper triangle, YX order: (0,0)-&gt;(0,1)-&gt;(1,1) */</span>
<span class="lineNum">     219 </span>            : 
<span class="lineNum">     220 </span>            :     /* A step of (1,0) in (i,j) means a step of (1-c,-c) in (x,y), and */
<span class="lineNum">     221 </span>            :     /* a step of (0,1) in (i,j) means a step of (-c,1-c) in (x,y), where */
<span class="lineNum">     222 </span>            :     /* c = (3-sqrt(3))/6 */
<span class="lineNum">     223 </span>            : 
<span class="lineNum">     224 </span><span class="lineCov">     570912 :     x1 = x0 - i1 + G2; /* Offsets for middle corner in (x,y) unskewed coords */</span>
<span class="lineNum">     225 </span><span class="lineCov">     570912 :     y1 = y0 - j1 + G2;</span>
<span class="lineNum">     226 </span><span class="lineCov">     570912 :     x2 = x0 - 1.0f + 2.0f * G2; /* Offsets for last corner in (x,y) unskewed coords */</span>
<span class="lineNum">     227 </span><span class="lineCov">     570912 :     y2 = y0 - 1.0f + 2.0f * G2;</span>
<span class="lineNum">     228 </span>            : 
<span class="lineNum">     229 </span>            :     /* Wrap the integer indices at 256, to avoid indexing perm[] out of bounds */
<span class="lineNum">     230 </span><span class="lineCov">     570912 :     ii = i % 256;</span>
<span class="lineNum">     231 </span><span class="lineCov">     570912 :     jj = j % 256;</span>
<span class="lineNum">     232 </span>            : 
<span class="lineNum">     233 </span>            :     /* Calculate the contribution from the three corners */
<span class="lineNum">     234 </span><span class="lineCov">     570912 :     t0 = 0.5f - x0*x0-y0*y0;</span>
<span class="lineNum">     235 </span><span class="lineCov">     570912 :     if(t0 &lt; 0.0f) n0 = 0.0f;</span>
<span class="lineNum">     236 </span>            :     else {
<span class="lineNum">     237 </span><span class="lineCov">     518079 :       t0 *= t0;</span>
<span class="lineNum">     238 </span><span class="lineCov">     518079 :       n0 = t0 * t0 * grad2(perm[ii+perm[jj]], x0, y0); </span>
<span class="lineNum">     239 </span>            :     }
<span class="lineNum">     240 </span>            : 
<span class="lineNum">     241 </span><span class="lineCov">     570912 :     t1 = 0.5f - x1*x1-y1*y1;</span>
<span class="lineNum">     242 </span><span class="lineCov">     570912 :     if(t1 &lt; 0.0f) n1 = 0.0f;</span>
<span class="lineNum">     243 </span>            :     else {
<span class="lineNum">     244 </span><span class="lineCov">     517902 :       t1 *= t1;</span>
<span class="lineNum">     245 </span><span class="lineCov">     517902 :       n1 = t1 * t1 * grad2(perm[ii+i1+perm[jj+j1]], x1, y1);</span>
<span class="lineNum">     246 </span>            :     }
<span class="lineNum">     247 </span>            : 
<span class="lineNum">     248 </span><span class="lineCov">     570912 :     t2 = 0.5f - x2*x2-y2*y2;</span>
<span class="lineNum">     249 </span><span class="lineCov">     570912 :     if(t2 &lt; 0.0f) n2 = 0.0f;</span>
<span class="lineNum">     250 </span>            :     else {
<span class="lineNum">     251 </span><span class="lineCov">     517516 :       t2 *= t2;</span>
<span class="lineNum">     252 </span><span class="lineCov">     517516 :       n2 = t2 * t2 * grad2(perm[ii+1+perm[jj+1]], x2, y2);</span>
<span class="lineNum">     253 </span>            :     }
<span class="lineNum">     254 </span>            : 
<span class="lineNum">     255 </span>            :     /* Add contributions from each corner to get the final noise value. */
<span class="lineNum">     256 </span>            :     /* The result is scaled to return values in the interval [-1,1]. */
<span class="lineNum">     257 </span><span class="lineCov">     570912 :     return 40.0f * (n0 + n1 + n2); /* TODO: The scale factor is preliminary! */</span>
<span class="lineNum">     258 </span>            : }
<a name="259"><span class="lineNum">     259 </span>            : </a>
<span class="lineNum">     260 </span>            : /* 3D simplex noise */
<span class="lineNum">     261 </span><span class="lineCov">   25526470 : static float _slang_library_noise3 (float x, float y, float z)</span>
<span class="lineNum">     262 </span>            : {
<span class="lineNum">     263 </span>            : /* Simple skewing factors for the 3D case */
<span class="lineNum">     264 </span>            : #define F3 0.333333333f
<span class="lineNum">     265 </span>            : #define G3 0.166666667f
<span class="lineNum">     266 </span>            : 
<span class="lineNum">     267 </span>            :     float n0, n1, n2, n3; /* Noise contributions from the four corners */
<span class="lineNum">     268 </span>            : 
<span class="lineNum">     269 </span>            :     /* Skew the input space to determine which simplex cell we're in */
<span class="lineNum">     270 </span><span class="lineCov">   25526470 :     float s = (x+y+z)*F3; /* Very nice and simple skew factor for 3D */</span>
<span class="lineNum">     271 </span><span class="lineCov">   25526470 :     float xs = x+s;</span>
<span class="lineNum">     272 </span><span class="lineCov">   25526470 :     float ys = y+s;</span>
<span class="lineNum">     273 </span><span class="lineCov">   25526470 :     float zs = z+s;</span>
<span class="lineNum">     274 </span><span class="lineCov">   25526470 :     int i = FASTFLOOR(xs);</span>
<span class="lineNum">     275 </span><span class="lineCov">   25526470 :     int j = FASTFLOOR(ys);</span>
<span class="lineNum">     276 </span><span class="lineCov">   25526470 :     int k = FASTFLOOR(zs);</span>
<span class="lineNum">     277 </span>            : 
<span class="lineNum">     278 </span><span class="lineCov">   25526470 :     float t = (float)(i+j+k)*G3; </span>
<span class="lineNum">     279 </span><span class="lineCov">   25526470 :     float X0 = i-t; /* Unskew the cell origin back to (x,y,z) space */</span>
<span class="lineNum">     280 </span><span class="lineCov">   25526470 :     float Y0 = j-t;</span>
<span class="lineNum">     281 </span><span class="lineCov">   25526470 :     float Z0 = k-t;</span>
<span class="lineNum">     282 </span><span class="lineCov">   25526470 :     float x0 = x-X0; /* The x,y,z distances from the cell origin */</span>
<span class="lineNum">     283 </span><span class="lineCov">   25526470 :     float y0 = y-Y0;</span>
<span class="lineNum">     284 </span><span class="lineCov">   25526470 :     float z0 = z-Z0;</span>
<span class="lineNum">     285 </span>            : 
<span class="lineNum">     286 </span>            :     float x1, y1, z1, x2, y2, z2, x3, y3, z3;
<span class="lineNum">     287 </span>            :     int ii, jj, kk;
<span class="lineNum">     288 </span>            :     float t0, t1, t2, t3;
<span class="lineNum">     289 </span>            : 
<span class="lineNum">     290 </span>            :     /* For the 3D case, the simplex shape is a slightly irregular tetrahedron. */
<span class="lineNum">     291 </span>            :     /* Determine which simplex we are in. */
<span class="lineNum">     292 </span>            :     int i1, j1, k1; /* Offsets for second corner of simplex in (i,j,k) coords */
<span class="lineNum">     293 </span>            :     int i2, j2, k2; /* Offsets for third corner of simplex in (i,j,k) coords */
<span class="lineNum">     294 </span>            : 
<span class="lineNum">     295 </span>            : /* This code would benefit from a backport from the GLSL version! */
<span class="lineNum">     296 </span><span class="lineCov">   25526470 :     if(x0&gt;=y0) {</span>
<span class="lineNum">     297 </span><span class="lineCov">   12807657 :       if(y0&gt;=z0)</span>
<span class="lineNum">     298 </span><span class="lineCov">    4318912 :         { i1=1; j1=0; k1=0; i2=1; j2=1; k2=0; } /* X Y Z order */</span>
<span class="lineNum">     299 </span><span class="lineCov">    8488745 :         else if(x0&gt;=z0) { i1=1; j1=0; k1=0; i2=1; j2=0; k2=1; } /* X Z Y order */</span>
<span class="lineNum">     300 </span><span class="lineCov">    4212657 :         else { i1=0; j1=0; k1=1; i2=1; j2=0; k2=1; } /* Z X Y order */</span>
<span class="lineNum">     301 </span>            :       }
<span class="lineNum">     302 </span>            :     else { /* x0&lt;y0 */
<span class="lineNum">     303 </span><span class="lineCov">   12718813 :       if(y0&lt;z0) { i1=0; j1=0; k1=1; i2=0; j2=1; k2=1; } /* Z Y X order */</span>
<span class="lineNum">     304 </span><span class="lineCov">    8449507 :       else if(x0&lt;z0) { i1=0; j1=1; k1=0; i2=0; j2=1; k2=1; } /* Y Z X order */</span>
<span class="lineNum">     305 </span><span class="lineCov">    4183740 :       else { i1=0; j1=1; k1=0; i2=1; j2=1; k2=0; } /* Y X Z order */</span>
<span class="lineNum">     306 </span>            :     }
<span class="lineNum">     307 </span>            : 
<span class="lineNum">     308 </span>            :     /* A step of (1,0,0) in (i,j,k) means a step of (1-c,-c,-c) in (x,y,z), */
<span class="lineNum">     309 </span>            :     /* a step of (0,1,0) in (i,j,k) means a step of (-c,1-c,-c) in (x,y,z), and */
<span class="lineNum">     310 </span>            :     /* a step of (0,0,1) in (i,j,k) means a step of (-c,-c,1-c) in (x,y,z), where */
<span class="lineNum">     311 </span>            :     /* c = 1/6. */
<span class="lineNum">     312 </span>            : 
<span class="lineNum">     313 </span><span class="lineCov">   25526470 :     x1 = x0 - i1 + G3; /* Offsets for second corner in (x,y,z) coords */</span>
<span class="lineNum">     314 </span><span class="lineCov">   25526470 :     y1 = y0 - j1 + G3;</span>
<span class="lineNum">     315 </span><span class="lineCov">   25526470 :     z1 = z0 - k1 + G3;</span>
<span class="lineNum">     316 </span><span class="lineCov">   25526470 :     x2 = x0 - i2 + 2.0f*G3; /* Offsets for third corner in (x,y,z) coords */</span>
<span class="lineNum">     317 </span><span class="lineCov">   25526470 :     y2 = y0 - j2 + 2.0f*G3;</span>
<span class="lineNum">     318 </span><span class="lineCov">   25526470 :     z2 = z0 - k2 + 2.0f*G3;</span>
<span class="lineNum">     319 </span><span class="lineCov">   25526470 :     x3 = x0 - 1.0f + 3.0f*G3; /* Offsets for last corner in (x,y,z) coords */</span>
<span class="lineNum">     320 </span><span class="lineCov">   25526470 :     y3 = y0 - 1.0f + 3.0f*G3;</span>
<span class="lineNum">     321 </span><span class="lineCov">   25526470 :     z3 = z0 - 1.0f + 3.0f*G3;</span>
<span class="lineNum">     322 </span>            : 
<span class="lineNum">     323 </span>            :     /* Wrap the integer indices at 256, to avoid indexing perm[] out of bounds */
<span class="lineNum">     324 </span><span class="lineCov">   25526470 :     ii = i % 256;</span>
<span class="lineNum">     325 </span><span class="lineCov">   25526470 :     jj = j % 256;</span>
<span class="lineNum">     326 </span><span class="lineCov">   25526470 :     kk = k % 256;</span>
<span class="lineNum">     327 </span>            : 
<span class="lineNum">     328 </span>            :     /* Calculate the contribution from the four corners */
<span class="lineNum">     329 </span><span class="lineCov">   25526470 :     t0 = 0.6f - x0*x0 - y0*y0 - z0*z0;</span>
<span class="lineNum">     330 </span><span class="lineCov">   25526470 :     if(t0 &lt; 0.0f) n0 = 0.0f;</span>
<span class="lineNum">     331 </span>            :     else {
<span class="lineNum">     332 </span><span class="lineCov">   23179511 :       t0 *= t0;</span>
<span class="lineNum">     333 </span><span class="lineCov">   23179511 :       n0 = t0 * t0 * grad3(perm[ii+perm[jj+perm[kk]]], x0, y0, z0);</span>
<span class="lineNum">     334 </span>            :     }
<span class="lineNum">     335 </span>            : 
<span class="lineNum">     336 </span><span class="lineCov">   25526470 :     t1 = 0.6f - x1*x1 - y1*y1 - z1*z1;</span>
<span class="lineNum">     337 </span><span class="lineCov">   25526470 :     if(t1 &lt; 0.0f) n1 = 0.0f;</span>
<span class="lineNum">     338 </span>            :     else {
<span class="lineNum">     339 </span><span class="lineCov">   23047360 :       t1 *= t1;</span>
<span class="lineNum">     340 </span><span class="lineCov">   23047360 :       n1 = t1 * t1 * grad3(perm[ii+i1+perm[jj+j1+perm[kk+k1]]], x1, y1, z1);</span>
<span class="lineNum">     341 </span>            :     }
<span class="lineNum">     342 </span>            : 
<span class="lineNum">     343 </span><span class="lineCov">   25526470 :     t2 = 0.6f - x2*x2 - y2*y2 - z2*z2;</span>
<span class="lineNum">     344 </span><span class="lineCov">   25526470 :     if(t2 &lt; 0.0f) n2 = 0.0f;</span>
<span class="lineNum">     345 </span>            :     else {
<span class="lineNum">     346 </span><span class="lineCov">   23058777 :       t2 *= t2;</span>
<span class="lineNum">     347 </span><span class="lineCov">   23058777 :       n2 = t2 * t2 * grad3(perm[ii+i2+perm[jj+j2+perm[kk+k2]]], x2, y2, z2);</span>
<span class="lineNum">     348 </span>            :     }
<span class="lineNum">     349 </span>            : 
<span class="lineNum">     350 </span><span class="lineCov">   25526470 :     t3 = 0.6f - x3*x3 - y3*y3 - z3*z3;</span>
<span class="lineNum">     351 </span><span class="lineCov">   25526470 :     if(t3&lt;0.0f) n3 = 0.0f;</span>
<span class="lineNum">     352 </span>            :     else {
<span class="lineNum">     353 </span><span class="lineCov">   23185996 :       t3 *= t3;</span>
<span class="lineNum">     354 </span><span class="lineCov">   23185996 :       n3 = t3 * t3 * grad3(perm[ii+1+perm[jj+1+perm[kk+1]]], x3, y3, z3);</span>
<span class="lineNum">     355 </span>            :     }
<span class="lineNum">     356 </span>            : 
<span class="lineNum">     357 </span>            :     /* Add contributions from each corner to get the final noise value. */
<span class="lineNum">     358 </span>            :     /* The result is scaled to stay just inside [-1,1] */
<span class="lineNum">     359 </span><span class="lineCov">   25526470 :     return 32.0f * (n0 + n1 + n2 + n3); /* TODO: The scale factor is preliminary! */</span>
<span class="lineNum">     360 </span>            : }
<a name="361"><span class="lineNum">     361 </span>            : </a>
<span class="lineNum">     362 </span>            : /* 4D simplex noise */
<span class="lineNum">     363 </span><span class="lineCov">   45544824 : static float _slang_library_noise4 (float x, float y, float z, float w)</span>
<span class="lineNum">     364 </span>            : {
<span class="lineNum">     365 </span>            :   /* The skewing and unskewing factors are hairy again for the 4D case */
<span class="lineNum">     366 </span>            : #define F4 0.309016994f /* F4 = (Math.sqrt(5.0)-1.0)/4.0 */
<span class="lineNum">     367 </span>            : #define G4 0.138196601f /* G4 = (5.0-Math.sqrt(5.0))/20.0 */
<span class="lineNum">     368 </span>            : 
<span class="lineNum">     369 </span>            :     float n0, n1, n2, n3, n4; /* Noise contributions from the five corners */
<span class="lineNum">     370 </span>            : 
<span class="lineNum">     371 </span>            :     /* Skew the (x,y,z,w) space to determine which cell of 24 simplices we're in */
<span class="lineNum">     372 </span><span class="lineCov">   45544824 :     float s = (x + y + z + w) * F4; /* Factor for 4D skewing */</span>
<span class="lineNum">     373 </span><span class="lineCov">   45544824 :     float xs = x + s;</span>
<span class="lineNum">     374 </span><span class="lineCov">   45544824 :     float ys = y + s;</span>
<span class="lineNum">     375 </span><span class="lineCov">   45544824 :     float zs = z + s;</span>
<span class="lineNum">     376 </span><span class="lineCov">   45544824 :     float ws = w + s;</span>
<span class="lineNum">     377 </span><span class="lineCov">   45544824 :     int i = FASTFLOOR(xs);</span>
<span class="lineNum">     378 </span><span class="lineCov">   45544824 :     int j = FASTFLOOR(ys);</span>
<span class="lineNum">     379 </span><span class="lineCov">   45544824 :     int k = FASTFLOOR(zs);</span>
<span class="lineNum">     380 </span><span class="lineCov">   45544824 :     int l = FASTFLOOR(ws);</span>
<span class="lineNum">     381 </span>            : 
<span class="lineNum">     382 </span><span class="lineCov">   45544824 :     float t = (i + j + k + l) * G4; /* Factor for 4D unskewing */</span>
<span class="lineNum">     383 </span><span class="lineCov">   45544824 :     float X0 = i - t; /* Unskew the cell origin back to (x,y,z,w) space */</span>
<span class="lineNum">     384 </span><span class="lineCov">   45544824 :     float Y0 = j - t;</span>
<span class="lineNum">     385 </span><span class="lineCov">   45544824 :     float Z0 = k - t;</span>
<span class="lineNum">     386 </span><span class="lineCov">   45544824 :     float W0 = l - t;</span>
<span class="lineNum">     387 </span>            : 
<span class="lineNum">     388 </span><span class="lineCov">   45544824 :     float x0 = x - X0;  /* The x,y,z,w distances from the cell origin */</span>
<span class="lineNum">     389 </span><span class="lineCov">   45544824 :     float y0 = y - Y0;</span>
<span class="lineNum">     390 </span><span class="lineCov">   45544824 :     float z0 = z - Z0;</span>
<span class="lineNum">     391 </span><span class="lineCov">   45544824 :     float w0 = w - W0;</span>
<span class="lineNum">     392 </span>            : 
<span class="lineNum">     393 </span>            :     /* For the 4D case, the simplex is a 4D shape I won't even try to describe. */
<span class="lineNum">     394 </span>            :     /* To find out which of the 24 possible simplices we're in, we need to */
<span class="lineNum">     395 </span>            :     /* determine the magnitude ordering of x0, y0, z0 and w0. */
<span class="lineNum">     396 </span>            :     /* The method below is a good way of finding the ordering of x,y,z,w and */
<span class="lineNum">     397 </span>            :     /* then find the correct traversal order for the simplex we're in. */
<span class="lineNum">     398 </span>            :     /* First, six pair-wise comparisons are performed between each possible pair */
<span class="lineNum">     399 </span>            :     /* of the four coordinates, and the results are used to add up binary bits */
<span class="lineNum">     400 </span>            :     /* for an integer index. */
<span class="lineNum">     401 </span><span class="lineCov">   45544824 :     int c1 = (x0 &gt; y0) ? 32 : 0;</span>
<span class="lineNum">     402 </span><span class="lineCov">   45544824 :     int c2 = (x0 &gt; z0) ? 16 : 0;</span>
<span class="lineNum">     403 </span><span class="lineCov">   45544824 :     int c3 = (y0 &gt; z0) ? 8 : 0;</span>
<span class="lineNum">     404 </span><span class="lineCov">   45544824 :     int c4 = (x0 &gt; w0) ? 4 : 0;</span>
<span class="lineNum">     405 </span><span class="lineCov">   45544824 :     int c5 = (y0 &gt; w0) ? 2 : 0;</span>
<span class="lineNum">     406 </span><span class="lineCov">   45544824 :     int c6 = (z0 &gt; w0) ? 1 : 0;</span>
<span class="lineNum">     407 </span><span class="lineCov">   45544824 :     int c = c1 + c2 + c3 + c4 + c5 + c6;</span>
<span class="lineNum">     408 </span>            : 
<span class="lineNum">     409 </span>            :     int i1, j1, k1, l1; /* The integer offsets for the second simplex corner */
<span class="lineNum">     410 </span>            :     int i2, j2, k2, l2; /* The integer offsets for the third simplex corner */
<span class="lineNum">     411 </span>            :     int i3, j3, k3, l3; /* The integer offsets for the fourth simplex corner */
<span class="lineNum">     412 </span>            : 
<span class="lineNum">     413 </span>            :     float x1, y1, z1, w1, x2, y2, z2, w2, x3, y3, z3, w3, x4, y4, z4, w4;
<span class="lineNum">     414 </span>            :     int ii, jj, kk, ll;
<span class="lineNum">     415 </span>            :     float t0, t1, t2, t3, t4;
<span class="lineNum">     416 </span>            : 
<span class="lineNum">     417 </span>            :     /* simplex[c] is a 4-vector with the numbers 0, 1, 2 and 3 in some order. */
<span class="lineNum">     418 </span>            :     /* Many values of c will never occur, since e.g. x&gt;y&gt;z&gt;w makes x&lt;z, y&lt;w and x&lt;w */
<span class="lineNum">     419 </span>            :     /* impossible. Only the 24 indices which have non-zero entries make any sense. */
<span class="lineNum">     420 </span>            :     /* We use a thresholding to set the coordinates in turn from the largest magnitude. */
<span class="lineNum">     421 </span>            :     /* The number 3 in the &quot;simplex&quot; array is at the position of the largest coordinate. */
<span class="lineNum">     422 </span><span class="lineCov">   45544824 :     i1 = simplex[c][0]&gt;=3 ? 1 : 0;</span>
<span class="lineNum">     423 </span><span class="lineCov">   45544824 :     j1 = simplex[c][1]&gt;=3 ? 1 : 0;</span>
<span class="lineNum">     424 </span><span class="lineCov">   45544824 :     k1 = simplex[c][2]&gt;=3 ? 1 : 0;</span>
<span class="lineNum">     425 </span><span class="lineCov">   45544824 :     l1 = simplex[c][3]&gt;=3 ? 1 : 0;</span>
<span class="lineNum">     426 </span>            :     /* The number 2 in the &quot;simplex&quot; array is at the second largest coordinate. */
<span class="lineNum">     427 </span><span class="lineCov">   45544824 :     i2 = simplex[c][0]&gt;=2 ? 1 : 0;</span>
<span class="lineNum">     428 </span><span class="lineCov">   45544824 :     j2 = simplex[c][1]&gt;=2 ? 1 : 0;</span>
<span class="lineNum">     429 </span><span class="lineCov">   45544824 :     k2 = simplex[c][2]&gt;=2 ? 1 : 0;</span>
<span class="lineNum">     430 </span><span class="lineCov">   45544824 :     l2 = simplex[c][3]&gt;=2 ? 1 : 0;</span>
<span class="lineNum">     431 </span>            :     /* The number 1 in the &quot;simplex&quot; array is at the second smallest coordinate. */
<span class="lineNum">     432 </span><span class="lineCov">   45544824 :     i3 = simplex[c][0]&gt;=1 ? 1 : 0;</span>
<span class="lineNum">     433 </span><span class="lineCov">   45544824 :     j3 = simplex[c][1]&gt;=1 ? 1 : 0;</span>
<span class="lineNum">     434 </span><span class="lineCov">   45544824 :     k3 = simplex[c][2]&gt;=1 ? 1 : 0;</span>
<span class="lineNum">     435 </span><span class="lineCov">   45544824 :     l3 = simplex[c][3]&gt;=1 ? 1 : 0;</span>
<span class="lineNum">     436 </span>            :     /* The fifth corner has all coordinate offsets = 1, so no need to look that up. */
<span class="lineNum">     437 </span>            : 
<span class="lineNum">     438 </span><span class="lineCov">   45544824 :     x1 = x0 - i1 + G4; /* Offsets for second corner in (x,y,z,w) coords */</span>
<span class="lineNum">     439 </span><span class="lineCov">   45544824 :     y1 = y0 - j1 + G4;</span>
<span class="lineNum">     440 </span><span class="lineCov">   45544824 :     z1 = z0 - k1 + G4;</span>
<span class="lineNum">     441 </span><span class="lineCov">   45544824 :     w1 = w0 - l1 + G4;</span>
<span class="lineNum">     442 </span><span class="lineCov">   45544824 :     x2 = x0 - i2 + 2.0f*G4; /* Offsets for third corner in (x,y,z,w) coords */</span>
<span class="lineNum">     443 </span><span class="lineCov">   45544824 :     y2 = y0 - j2 + 2.0f*G4;</span>
<span class="lineNum">     444 </span><span class="lineCov">   45544824 :     z2 = z0 - k2 + 2.0f*G4;</span>
<span class="lineNum">     445 </span><span class="lineCov">   45544824 :     w2 = w0 - l2 + 2.0f*G4;</span>
<span class="lineNum">     446 </span><span class="lineCov">   45544824 :     x3 = x0 - i3 + 3.0f*G4; /* Offsets for fourth corner in (x,y,z,w) coords */</span>
<span class="lineNum">     447 </span><span class="lineCov">   45544824 :     y3 = y0 - j3 + 3.0f*G4;</span>
<span class="lineNum">     448 </span><span class="lineCov">   45544824 :     z3 = z0 - k3 + 3.0f*G4;</span>
<span class="lineNum">     449 </span><span class="lineCov">   45544824 :     w3 = w0 - l3 + 3.0f*G4;</span>
<span class="lineNum">     450 </span><span class="lineCov">   45544824 :     x4 = x0 - 1.0f + 4.0f*G4; /* Offsets for last corner in (x,y,z,w) coords */</span>
<span class="lineNum">     451 </span><span class="lineCov">   45544824 :     y4 = y0 - 1.0f + 4.0f*G4;</span>
<span class="lineNum">     452 </span><span class="lineCov">   45544824 :     z4 = z0 - 1.0f + 4.0f*G4;</span>
<span class="lineNum">     453 </span><span class="lineCov">   45544824 :     w4 = w0 - 1.0f + 4.0f*G4;</span>
<span class="lineNum">     454 </span>            : 
<span class="lineNum">     455 </span>            :     /* Wrap the integer indices at 256, to avoid indexing perm[] out of bounds */
<span class="lineNum">     456 </span><span class="lineCov">   45544824 :     ii = i % 256;</span>
<span class="lineNum">     457 </span><span class="lineCov">   45544824 :     jj = j % 256;</span>
<span class="lineNum">     458 </span><span class="lineCov">   45544824 :     kk = k % 256;</span>
<span class="lineNum">     459 </span><span class="lineCov">   45544824 :     ll = l % 256;</span>
<span class="lineNum">     460 </span>            : 
<span class="lineNum">     461 </span>            :     /* Calculate the contribution from the five corners */
<span class="lineNum">     462 </span><span class="lineCov">   45544824 :     t0 = 0.6f - x0*x0 - y0*y0 - z0*z0 - w0*w0;</span>
<span class="lineNum">     463 </span><span class="lineCov">   45544824 :     if(t0 &lt; 0.0f) n0 = 0.0f;</span>
<span class="lineNum">     464 </span>            :     else {
<span class="lineNum">     465 </span><span class="lineCov">   35653276 :       t0 *= t0;</span>
<span class="lineNum">     466 </span><span class="lineCov">   35653276 :       n0 = t0 * t0 * grad4(perm[ii+perm[jj+perm[kk+perm[ll]]]], x0, y0, z0, w0);</span>
<span class="lineNum">     467 </span>            :     }
<span class="lineNum">     468 </span>            : 
<span class="lineNum">     469 </span><span class="lineCov">   45544824 :    t1 = 0.6f - x1*x1 - y1*y1 - z1*z1 - w1*w1;</span>
<span class="lineNum">     470 </span><span class="lineCov">   45544824 :     if(t1 &lt; 0.0f) n1 = 0.0f;</span>
<span class="lineNum">     471 </span>            :     else {
<span class="lineNum">     472 </span><span class="lineCov">   35595599 :       t1 *= t1;</span>
<span class="lineNum">     473 </span><span class="lineCov">   35595599 :       n1 = t1 * t1 * grad4(perm[ii+i1+perm[jj+j1+perm[kk+k1+perm[ll+l1]]]], x1, y1, z1, w1);</span>
<span class="lineNum">     474 </span>            :     }
<span class="lineNum">     475 </span>            : 
<span class="lineNum">     476 </span><span class="lineCov">   45544824 :    t2 = 0.6f - x2*x2 - y2*y2 - z2*z2 - w2*w2;</span>
<span class="lineNum">     477 </span><span class="lineCov">   45544824 :     if(t2 &lt; 0.0f) n2 = 0.0f;</span>
<span class="lineNum">     478 </span>            :     else {
<span class="lineNum">     479 </span><span class="lineCov">   35626034 :       t2 *= t2;</span>
<span class="lineNum">     480 </span><span class="lineCov">   35626034 :       n2 = t2 * t2 * grad4(perm[ii+i2+perm[jj+j2+perm[kk+k2+perm[ll+l2]]]], x2, y2, z2, w2);</span>
<span class="lineNum">     481 </span>            :     }
<span class="lineNum">     482 </span>            : 
<span class="lineNum">     483 </span><span class="lineCov">   45544824 :    t3 = 0.6f - x3*x3 - y3*y3 - z3*z3 - w3*w3;</span>
<span class="lineNum">     484 </span><span class="lineCov">   45544824 :     if(t3 &lt; 0.0f) n3 = 0.0f;</span>
<span class="lineNum">     485 </span>            :     else {
<span class="lineNum">     486 </span><span class="lineCov">   35024115 :       t3 *= t3;</span>
<span class="lineNum">     487 </span><span class="lineCov">   35024115 :       n3 = t3 * t3 * grad4(perm[ii+i3+perm[jj+j3+perm[kk+k3+perm[ll+l3]]]], x3, y3, z3, w3);</span>
<span class="lineNum">     488 </span>            :     }
<span class="lineNum">     489 </span>            : 
<span class="lineNum">     490 </span><span class="lineCov">   45544824 :    t4 = 0.6f - x4*x4 - y4*y4 - z4*z4 - w4*w4;</span>
<span class="lineNum">     491 </span><span class="lineCov">   45544824 :     if(t4 &lt; 0.0f) n4 = 0.0f;</span>
<span class="lineNum">     492 </span>            :     else {
<span class="lineNum">     493 </span><span class="lineCov">   35610392 :       t4 *= t4;</span>
<span class="lineNum">     494 </span><span class="lineCov">   35610392 :       n4 = t4 * t4 * grad4(perm[ii+1+perm[jj+1+perm[kk+1+perm[ll+1]]]], x4, y4, z4, w4);</span>
<span class="lineNum">     495 </span>            :     }
<span class="lineNum">     496 </span>            : 
<span class="lineNum">     497 </span>            :     /* Sum up and scale the result to cover the range [-1,1] */
<span class="lineNum">     498 </span><span class="lineCov">   45544824 :     return 27.0f * (n0 + n1 + n2 + n3 + n4); /* TODO: The scale factor is preliminary! */</span>
<span class="lineNum">     499 </span>            : }
</pre>
      </td>
    </tr>
  </table>
  <br>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="ruler"><img src="../../../../../../../glass.png" width=3 height=3 alt=""></td></tr>
    <tr><td class="versionInfo">Generated by: <a href="http://ltp.sourceforge.net/coverage/lcov.php" target="_parent">LCOV version 1.9</a></td></tr>
  </table>
  <br>

</body>
</html>
